void Modbus_Framegen (char addr,char cmd, uint16_t reg, char buffer[]);
uint16_t Modbus_CRC(char buf[], int len);

#define MODBUS_ADDR 1
#define MODBUS_READ 4


union
{
    char c[4];
    float f;
}u;
/*
    char cVoltage[] = {0x01,0x04,0x00,0x00,0x00,0x02,0x71,0xCB};//voltage
    char cCurrent[] = {0x01,0x04,0x00,0x06,0x00,0x02,0x91,0xCA};//current
    char cPower[] = {0x01,0x04,0x00,0x0C,0x00,0x02,0xB1,0xC8};//wirkleistung
    char cAAPower[] = {0x01,0x04,0x00,0x12,0x00,0x02,0xD1,0xCE};//scheinleistung
    char cRAPower[] = {0x01,0x04,0x00,0x18,0x00,0x02,0xF1,0xCC};//blindleistung
    char cPFactor[] = {0x01,0x04,0x00,0x1E,0x00,0x02,0x11,0xCD};
    char cFrequency[] = {0x01,0x04,0x00,0x46,0x00,0x02,0x90,0x1E};
    char cIAEnergy[] = {0x01,0x04,0x00,0x48,0x00,0x02,0xF1,0xDD};
    char cEAEnergy[] = {0x01,0x04,0x00,0x4A,0x00,0x02,0x50,0x1D};
    char cTAEnergy[] = {0x01,0x04,0x01,0x56,0x00,0x02,0x90,0x27};

*/


typedef struct {
    char skip;
    uint16_t addr;
    char name[12];
    char unit [8];
} reg_t;

reg_t reg_to_read[]={
{0,0x0000,"voltage","V"},
{1,0x0006,"current","A"},
{0,0x000c,"power","W"},
{1,0x0012,"aapower","VAr"},
{1,0x0018,"rapower","VAr"},
{1,0x001e,"pfactor",""},
{0,0x0046,"frequency","Hz"},
{0,0x0048,"iaenergy","kWh"},
{0,0x004a,"eaenergy","kWh"},
{1,0x0156,"taenergy","kWh"}};

